<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ roster_name }} - Warhammer Roster</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

    <script>
        const onIdClick = (id) => {
            const targetDiv = document.getElementById(id);
            const yOffset = -10;

            if (targetDiv) {
                const newY = targetDiv.getBoundingClientRect().top + window.scrollY + yOffset;
                window.scrollTo({top: newY, behavior: 'smooth'});

                // TODO: Add a color highlighting effect
            }
        }
    </script>


    <header>
        <div class="textline-wrap">
            <h1 class="header-text">{{ roster_name }} - </h1>
            {% if cost_value <= cost_limit %}
                <h1 class="header-text"> {{ cost_value }}/{{ cost_limit }} {{ cost_string }}</h1>
            {% else %}
                <h1 class="header-text error-color"> {{ cost_value }}/{{ cost_limit }} {{ cost_string }}</h1>
            {% endif %}
        </div>
        <h3 class="medium-text">Roster generated by <a href="{{ newrecruit_link }}">{{ newrecruit_link }}</a></h3>
    </header>

    <main>

        <div class="army-info-div">
            <h1 class="faction-name">{{ faction_name }}</h1>

            <div class="army-rule-div">
                <pre class="medium-text"><span class="primary-color"><strong>{{ faction_rule_name }}</strong></span>: {{ faction_rule_description }}</pre>
            </div>

            <div class="army-rule-div">
                <pre class="medium-text"><span class="primary-color"><strong>{{ detachment_name }}</strong></span>: {{ detachment_description }}</pre>
            </div>
        </div>

        <h1 class="large-text top-margin">Selected units:</h1>

        <table class="selections-table">
            <tr>
                <th>Name</th>
                <th>Class</th>
                <th>Points</th>
            </tr>

            {% for unit in units %}
                <tr onclick="onIdClick('{{ unit['id'] }}')">
                    <td>{{ unit["name"] }}</td>
                    <td>{{ unit["categories"][0]["name"] }}</td>
                    <td>{{ unit["costs"][0]["value"] }}</td>
                </tr>
            {% endfor %}
        </table>

        <div class="units-div">

            {% for unit in units %}
                {% include "unit.html" %}
            {% endfor %}

        </div>

    </main>

    <footer>
        {% for rule in rules.items() %}
            <details id="{{ rule[0] }}" class="rule-div">
                 <summary class="header-text">{{ rule[1][0] }}</summary>

                 <h1 class="medium-text">{{ rule[1][1] }}</h1>
            </details>
        {% endfor %}
    </footer>
</body>
</html>
